apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: texflow

namespace: texflow

resources:
  # Base resources
  - base/namespace.yaml
  - base/configmap.yaml
  - base/secrets.yaml
  - base/ingress.yaml
  
  # Infrastructure
  - infrastructure/mongodb.yaml
  - infrastructure/redis.yaml
  - infrastructure/minio.yaml
  - infrastructure/kong.yaml
  
  # Backend services
  - services/auth-service.yaml
  - services/project-service.yaml
  - services/websocket-service.yaml
  - services/collaboration-service.yaml
  - services/compilation-service.yaml
  
  # Monitoring
  - monitoring/prometheus.yaml
  - monitoring/grafana.yaml

labels:
  - pairs:
      app.kubernetes.io/managed-by: kustomize
      app.kubernetes.io/part-of: texflow
    includeSelectors: false

# Image customization (update for your container registry)
images:
  - name: texflow/auth-service
    newTag: latest
  - name: texflow/project-service
    newTag: latest
  - name: texflow/websocket-service
    newTag: latest
  - name: texflow/collaboration-service
    newTag: latest
  - name: texflow/compilation-service
    newTag: latest
